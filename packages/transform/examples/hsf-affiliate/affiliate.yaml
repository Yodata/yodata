# transformation configuration
'addTelephone': &telephoneContactPoint
  id: telephone
  type: ContactPoint
  name: '#name'
# KeyOrder Plugin Configuration
'@keyOrder':
  - type
  - id
  - name
  - contactPoint
  - email
  - telephone
  - faxNumber
  - url
  - identifier

'@default':
  type: RealEstateOrganization
  ownerType: Person
  addressType: PostalAddress
  parentOrganizationType: OrganizationRole
  parentOrganizationRole: FranchiseAffiliate
  parentOrganizationValue: 'https://hsf.ds.bhhsresource.com/profile/card#me'

AffiliateDBA: name
AffiliateFax: faxNumber
AffiliatePrimaryWebSite: url
AffiliateBusinessPhone: *telephoneContactPoint
AffiliateOtherPhone: *telephoneContactPoint
AffiliatePublicPhone: *telephoneContactPoint
AffiliatePublicEmail:
  id: email
  type: ContactPoint
  name: $name

NonAgentCount: numberOfEmployees
NumberOfActiveOffices: numberOfSubOrganizations

AffiliateID: identifier.AffiliateID
BrokerID: identifier.BrokerID
AffiliateMLSID: identifier.AffiliateMLSID

addressType: address.type
AffiliateCountry: address.addressCountry
AffiliateCity: address.addressLocality
AffiliateState: address.addressRegion
AffiliateStreetAddress1: address.streetAddress
AffiliateStreetAddress2: address.streetAddress
AffiliateZipCode: address.postalCode

ownerType: owner.type
BrokerOwnerEmail: owner.email
BrokerOwnerFax: owner.faxNumber
BrokerOwnerLastName: owner.familyName
BrokerOwnerFirstName: owner.givenName
BrokerOwnerPhone: owner.telephone

FullTimeReportedCount: additionalProperty.FullTimeReportedCount
FullTimeRosterCount: additionalProperty.FullTimeRosterCount
PartTimeReportedCount: additionalProperty.PartTimeReportedCount
PartTimeRosterCount: additionalProperty.PartTimeRosterCount
FranchiseType: additionalProperty.FranchiseType
AffiliateStatus: additionalProperty.AffiliateStatus

parentOrganizationType: parentOrganization.type
parentOrganizationRole: parentOrganization.roleName
parentOrganizationValue: parentOrganization.parentOrganization
OriginalAffiliationDate: parentOrganization.startDate
RenewalDate: parentOrganization.renewalDate
ExpirationDate: parentOrganization.endDate

MobileLeadNotificationEmail: additionalProperty.MobileLeadNotificationEmail
MobileLeadNotificationPhone: additionalProperty.MobileLeadNotificationPhone
GrantedOnDate: startDate
DesignationType: roleName
MarketDesignationsList:
  id: memberOf
  value: '#MarketDesignationList'
  '@context':
    GrantedOnDate: startDate
    ExpirationDate: endDate
    DesignationType: roleName
    GrantingAuthority:
      key: memberOf
      val: !!js/function >
        props => ({type: 'RealEstateOrganization', name: props.value })

AffiliateMLSName1: &mlsMembership
  id: memberOf
  type:
    - OrganizationRole
    - MLSMembership
  value:
    memberOf:
      type: MultipleListingService
      name: $value
    memberId: $MLSID
    member: !!js/function >
      props => `https://${props.last['AffiliateID'].toLowerCase()}.ds.bhhsresource.com/profile/card#me`

  val: !!js/function >
    props => ({
    type: 'OrganizationRole',
    roleName: 'MLSMember',
    memberOf: { type: 'MultipleListingService', name: props.value },
    memberId: props.last[props.key.replace('MLSName','MLSID')],
    member: `https://${props.last['AffiliateID'].toLowerCase()}.ds.bhhsresource.com/profile/card#me`
    })
AffiliateMLSName2: *mlsMembership
AffiliateMLSName3: *mlsMembership
AffiliateMLSName4: *mlsMembership
AffiliateMLSName5: *mlsMembership
AffiliateMLSName6: *mlsMembership
AffiliateMLSName7: *mlsMembership
AffiliateMLSName8: *mlsMembership
AffiliateMLSName9: *mlsMembership
AffiliateMLSName10: *mlsMembership
AffiliateMLSName11: *mlsMembership
AffiliateMLSName12: *mlsMembership
AffiliateMLSName13: *mlsMembership
AffiliateMLSName14: *mlsMembership
AffiliateMLSName15: *mlsMembership

# hidden keys
AffiliateMLSID1: !!null
AffiliateMLSID2: !!null
AffiliateMLSID3: !!null
AffiliateMLSID4: !!null
AffiliateMLSID5: !!null
AffiliateMLSID6: !!null
AffiliateMLSID7: !!null
AffiliateMLSID8: !!null
AffiliateMLSID9: !!null
AffiliateMLSID10: !!null
AffiliateMLSID11: !!null
AffiliateMLSID12: !!null
AffiliateMLSID13: !!null
AffiliateMLSID14: !!null
AffiliateMLSID15: !!null

email:
  '@container': '@set'